<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="A DBI-compatible interface to ODBC databases.">
<title>Connect to ODBC Compatible Databases (using the DBI Interface) • odbc</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Connect to ODBC Compatible Databases (using the DBI Interface)">
<meta property="og:description" content="A DBI-compatible interface to ODBC databases.">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">odbc</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.3.3.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-dbi/odbc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="odbc">odbc<a class="anchor" aria-label="anchor" href="#odbc"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of the odbc package is to provide a DBI-compliant interface to <a href="https://docs.microsoft.com/en-us/sql/odbc/microsoft-open-database-connectivity-odbc?view=sql-server-ver15" class="external-link">Open Database Connectivity</a> (ODBC) drivers. This allows for an efficient, easy to setup connection to any database with ODBC drivers available, including <a href="https://www.microsoft.com/en-us/sql-server/" class="external-link">SQL Server</a>, <a href="https://www.oracle.com/database" class="external-link">Oracle</a>, <a href="https://www.mysql.com/" class="external-link">MySQL</a>, <a href="https://www.postgresql.org/" class="external-link">PostgreSQL</a>, <a href="https://sqlite.org/index.html" class="external-link">SQLite</a> and others. The implementation builds on the <a href="https://nanodbc.github.io/nanodbc/" class="external-link">nanodbc</a> C++ library.</p>
<ul>
<li>
<a href="#installation">Installation</a>
<ul>
<li><a href="#windows">Windows</a></li>
<li><a href="#macos">MacOS</a></li>
<li><a href="#linux---debian-ubuntu">Linux - Debian / Ubuntu</a></li>
<li><a href="#r">R</a></li>
</ul>
</li>
<li>
<a href="#connecting-to-a-database">Connecting to a Database</a>
<ul>
<li><a href="#connection-strings">Connection Strings</a></li>
<li><a href="#dsn-configuration-files">DSN Configuration files</a></li>
</ul>
</li>
<li>
<a href="#usage">Usage</a>
<ul>
<li><a href="#table-and-field-information">Table and Field information</a></li>
<li><a href="#reading">Reading</a></li>
<li><a href="#writing">Writing</a></li>
<li><a href="#querying">Querying</a></li>
</ul>
</li>
<li>
<a href="#benchmarks">Benchmarks</a>
<ul>
<li><a href="#reading-1">Reading</a></li>
<li><a href="#writing-1">Writing</a></li>
</ul>
</li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>For Unix and MacOS ODBC drivers should be compiled against <a href="http://www.unixodbc.org/" class="external-link">unixODBC</a>. Drivers compiled against <a href="http://www.iodbc.org/" class="external-link">iODBC</a> <em>may</em> also work, but are not fully supported.</p>
<p>After installation of the driver manager and driver, you will have to register the driver in a <a href="#dsn-configuration-files">odbcinst.ini</a> file for it to appear in <code><a href="reference/odbcListDrivers.html">odbc::odbcListDrivers()</a></code>.</p>
<p><strong>odbc</strong> and it’s dependencies use C++11 features. Therefore you need <a href="https://gcc.gnu.org/" class="external-link">gcc 4.8</a>, <a href="https://clang.llvm.org" class="external-link">clang 3.3</a> or <a href="https://CRAN.R-project.org/bin/windows/Rtools/" class="external-link">Rtools 3.3</a> or later.</p>
<div class="section level3">
<h3 id="windows">Windows<a class="anchor" aria-label="anchor" href="#windows"></a>
</h3>
<p>Windows is bundled with ODBC libraries however drivers for each database need to be installed separately. Windows ODBC drivers typically include an installer that needs to be run and will install the driver to the proper locations.</p>
</div>
<div class="section level3">
<h3 id="macos">MacOS<a class="anchor" aria-label="anchor" href="#macos"></a>
</h3>
<p><a href="https://brew.sh/" class="external-link">homebrew</a> can be used to easily install database drivers on MacOS.</p>
<div class="section level4">
<h4 id="unixodbc---required-for-all-databases">UnixODBC - Required for all databases<a class="anchor" aria-label="anchor" href="#unixodbc---required-for-all-databases"></a>
</h4>
<pre class="shell"><code># Install the unixODBC library
brew install unixodbc</code></pre>
</div>
<div class="section level4">
<h4 id="common-db-drivers">Common DB drivers<a class="anchor" aria-label="anchor" href="#common-db-drivers"></a>
</h4>
<pre class="shell"><code># Microsoft SQL Server ODBC Drivers (Recommended)
brew tap microsoft/mssql-release https://github.com/Microsoft/homebrew-mssql-release
brew update
brew install msodbcsql17 mssql-tools

# SQL Server ODBC Drivers (Free TDS)
brew install freetds

# PostgreSQL ODBC ODBC Drivers
brew install psqlodbc

# MySQL ODBC Drivers (and database)
brew install mysql

# SQLite ODBC Drivers
brew install sqliteodbc</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="linux---debian--ubuntu">Linux - Debian / Ubuntu<a class="anchor" aria-label="anchor" href="#linux---debian--ubuntu"></a>
</h3>
<p><a href="https://wiki.debian.org/Apt" class="external-link">apt-get</a> can be used to easily install database drivers on Linux distributions which support it, such as Debian and Ubuntu.</p>
<div class="section level4">
<h4 id="unixodbc---required-for-all-databases-1">UnixODBC - Required for all databases<a class="anchor" aria-label="anchor" href="#unixodbc---required-for-all-databases-1"></a>
</h4>
<pre class="shell"><code># Install the unixODBC library
apt-get install unixodbc unixodbc-dev</code></pre>
</div>
<div class="section level4">
<h4 id="common-db-drivers-1">Common DB drivers<a class="anchor" aria-label="anchor" href="#common-db-drivers-1"></a>
</h4>
<p>For SQL Server on Linux it is recommended you use the <a href="https://docs.microsoft.com/en-us/sql/connect/odbc/linux-mac/installing-the-microsoft-odbc-driver-for-sql-server?view=sql-server-ver15#ubuntu" class="external-link">Microsoft Drivers</a>.</p>
<pre class="shell"><code># SQL Server ODBC Drivers (Free TDS)
apt-get install tdsodbc

# PostgreSQL ODBC ODBC Drivers
apt-get install odbc-postgresql

# MySQL ODBC Drivers
apt-get install libmyodbc

# SQLite ODBC Drivers
apt-get install libsqliteodbc</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="r">R<a class="anchor" aria-label="anchor" href="#r"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install the latest odbc release from CRAN:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"odbc"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or the the development version from GitHub:</span></span>
<span><span class="co"># install.packages(devtools)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"r-dbi/odbc"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="connecting-to-a-database">Connecting to a Database<a class="anchor" aria-label="anchor" href="#connecting-to-a-database"></a>
</h2>
<p>Databases can be connected by specifying a connection string directly, or with DSN configuration files.</p>
<div class="section level3">
<h3 id="connection-strings">Connection Strings<a class="anchor" aria-label="anchor" href="#connection-strings"></a>
</h3>
<p>Specify a connection string as named arguments directly in the <code><a href="reference/dbConnect-OdbcDriver-method.html">dbConnect()</a></code> method.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbConnect-OdbcDriver-method.html">dbConnect</a></span><span class="op">(</span><span class="fu">odbc</span><span class="fu">::</span><span class="fu"><a href="reference/odbc.html">odbc</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  driver <span class="op">=</span> <span class="st">"PostgreSQL Driver"</span>,</span>
<span>  database <span class="op">=</span> <span class="st">"test_db"</span>,</span>
<span>  uid <span class="op">=</span> <span class="st">"postgres"</span>,</span>
<span>  pwd <span class="op">=</span> <span class="st">"password"</span>,</span>
<span>  host <span class="op">=</span> <span class="st">"localhost"</span>,</span>
<span>  port <span class="op">=</span> <span class="fl">5432</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively you can pass a complete connection string as the <code>.connection_string</code> argument. <a href="https://www.connectionstrings.com" class="external-link">The Connection Strings Reference</a> is a useful resource that has example connection strings for a large variety of databases.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbConnect-OdbcDriver-method.html">dbConnect</a></span><span class="op">(</span><span class="fu">odbc</span><span class="fu">::</span><span class="fu"><a href="reference/odbc.html">odbc</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .connection_string <span class="op">=</span> <span class="st">"Driver={PostgreSQL Driver};Uid=postgres;Pwd=password;Host=localhost;Port=5432;Database=test_db;"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dsn-configuration-files">DSN Configuration files<a class="anchor" aria-label="anchor" href="#dsn-configuration-files"></a>
</h3>
<p>ODBC configuration files are another option to specify connection parameters and allow one to use a Data Source Name (DSN) to make it easier to connect to a database.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbConnect-OdbcDriver-method.html">dbConnect</a></span><span class="op">(</span><span class="fu">odbc</span><span class="fu">::</span><span class="fu"><a href="reference/odbc.html">odbc</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"PostgreSQL"</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="windows-1">Windows<a class="anchor" aria-label="anchor" href="#windows-1"></a>
</h4>
<p>The <a href="https://docs.microsoft.com/en-us/sql/odbc/admin/odbc-data-source-administrator?view=sql-server-ver15" class="external-link">ODBC Data Source Administrator</a> application is used to manage ODBC data sources on Windows.</p>
</div>
<div class="section level4">
<h4 id="macos--linux">MacOS / Linux<a class="anchor" aria-label="anchor" href="#macos--linux"></a>
</h4>
<p>On MacOS and Linux there are two separate text files that need to be edited. UnixODBC includes a command line executable <code>odbcinst</code> which can be used to query and modify the DSN files. However these are plain text files you can also edit by hand if desired.</p>
<p>There are two different files used to setup the DSN information.</p>
<ul>
<li>
<code>odbcinst.ini</code> - which defines driver options</li>
<li>
<code>odbc.ini</code> - which defines connection options</li>
</ul>
<p>The DSN configuration files can be defined globally for all users of the system, often at <code>/etc/odbc.ini</code> or <code>/opt/local/etc/odbc.ini</code>, the exact location depends on what option was used when compiling unixODBC. <code>odbcinst -j</code> can be used to find the exact location. Alternatively the <code>ODBCSYSINI</code> environment variable can be used to specify the location of the configuration files. Ex. <code>ODBCSYSINI=~/ODBC</code></p>
<p>A local DSN file can also be used with the files <code>~/.odbc.ini</code> and <code>~/.odbcinst.ini</code>.</p>
<div class="section level5">
<h5 id="odbcinstini">odbcinst.ini<a class="anchor" aria-label="anchor" href="#odbcinstini"></a>
</h5>
<p>Contains driver information, particularly the name of the driver library. Multiple drivers can be specified in the same file.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode ini"><code class="sourceCode ini"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[PostgreSQL Driver]</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="dt">Driver          </span><span class="ot">=</span><span class="st"> /usr/local/lib/psqlodbcw.so</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">[SQLite Driver]</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="dt">Driver          </span><span class="ot">=</span><span class="st"> /usr/local/lib/libsqlite3odbc.dylib</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="odbcini">odbc.ini<a class="anchor" aria-label="anchor" href="#odbcini"></a>
</h5>
<p>Contains connection information, particularly the username, password, database and host information. The Driver line corresponds to the driver defined in <code>odbcinst.ini</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode ini"><code class="sourceCode ini"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[PostgreSQL]</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="dt">Driver              </span><span class="ot">=</span><span class="st"> PostgreSQL Driver</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="dt">Database            </span><span class="ot">=</span><span class="st"> test_db</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="dt">Servername          </span><span class="ot">=</span><span class="st"> </span><span class="kw">localhost</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="dt">UserName            </span><span class="ot">=</span><span class="st"> postgres</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="dt">Password            </span><span class="ot">=</span><span class="st"> password</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="dt">Port                </span><span class="ot">=</span><span class="st"> </span><span class="dv">5432</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="kw">[SQLite]</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="dt">Driver          </span><span class="ot">=</span><span class="st"> SQLite Driver</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="dt">Database</span><span class="ot">=</span><span class="st">/tmp/testing</span></span></code></pre></div>
<p>See also: <a href="http://www.unixodbc.org/odbcinst.html" class="external-link">unixODBC without the GUI</a> for more information and examples.</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>All of the following examples assume you have already created a connection <code>con</code>. See <a href="#connecting-to-a-database">Connecting to a database</a> for more information on establishing a connection.</p>
<div class="section level3">
<h3 id="table-and-field-information">Table and Field information<a class="anchor" aria-label="anchor" href="#table-and-field-information"></a>
</h3>
<p><code><a href="reference/dbListTables-OdbcConnection-method.html">dbListTables()</a></code> is used for listing all existing tables in a database.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/dbListTables-OdbcConnection-method.html">dbListTables</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># List tables beginning with f</span></span>
<span><span class="fu"><a href="reference/dbListTables-OdbcConnection-method.html">dbListTables</a></span><span class="op">(</span><span class="va">con</span>, table_name <span class="op">=</span> <span class="st">"f%"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># List all fields in the 'flights' database</span></span>
<span><span class="fu"><a href="reference/dbListFields-OdbcConnection-character-method.html">dbListFields</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"flights"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reading">Reading<a class="anchor" aria-label="anchor" href="#reading"></a>
</h3>
<p><code><a href="https://dbi.r-dbi.org/reference/dbReadTable.html" class="external-link">dbReadTable()</a></code> will read a full table into an R <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbReadTable.html" class="external-link">dbReadTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"flights"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="writing">Writing<a class="anchor" aria-label="anchor" href="#writing"></a>
</h3>
<p><code><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html" class="external-link">dbWriteTable()</a></code> will write an R <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code> to an SQL table.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html" class="external-link">dbWriteTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"iris"</span>, <span class="va">iris</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="querying">Querying<a class="anchor" aria-label="anchor" href="#querying"></a>
</h3>
<p><code><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery()</a></code> will submit a query and fetch the results. It is also possible to submit the query and fetch separately with <code><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html" class="external-link">dbSendQuery()</a></code> and <code><a href="https://dbi.r-dbi.org/reference/dbFetch.html" class="external-link">dbFetch()</a></code>. The <code>n=</code> argument to <code><a href="https://dbi.r-dbi.org/reference/dbFetch.html" class="external-link">dbFetch()</a></code> can be used to fetch only the part of a query result (the next <em>n</em> rows).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html" class="external-link">dbSendQuery</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"SELECT flight, tailnum, origin FROM flights ORDER BY origin"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Retrieve the first 100 results</span></span>
<span><span class="va">first_100</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html" class="external-link">dbFetch</a></span><span class="op">(</span><span class="va">result</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Retrieve the rest of the results</span></span>
<span><span class="va">rest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html" class="external-link">dbFetch</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="benchmarks">Benchmarks<a class="anchor" aria-label="anchor" href="#benchmarks"></a>
</h2>
<p>The <em>odbc</em> package is often much faster than the existing <a href="https://cran.r-project.org/package=RODBC" class="external-link">RODBC</a> and DBI compatible <a href="https://cran.r-project.org/package=RODBCDBI" class="external-link">RODBCDBI</a> packages.</p>
<div class="section level3">
<h3 id="reading-1">Reading<a class="anchor" aria-label="anchor" href="#reading-1"></a>
</h3>
<p>Reading a table from a SQL Server database with the ‘flights’ dataset (336,776 rows, 19 columns) of the package <a href="https://github.com/tidyverse/nycflights13" class="external-link">nytflights13</a>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First using RODBC / RODBCDBI</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span></span>
<span><span class="va">rodbc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbConnect-OdbcDriver-method.html">dbConnect</a></span><span class="op">(</span><span class="fu">RODBCDBI</span><span class="fu">::</span><span class="fu">ODBC</span><span class="op">(</span><span class="op">)</span>, dsn <span class="op">=</span> <span class="st">"MicrosoftSQLServer"</span>, user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SQLSERVER_UID"</span><span class="op">)</span>, password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SQLSERVER_PWD"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">rodbc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbReadTable.html" class="external-link">dbReadTable</a></span><span class="op">(</span><span class="va">rodbc</span>, <span class="st">"flights"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;  13.986   1.173  15.192</span></span>
<span></span>
<span><span class="co"># Now using odbc</span></span>
<span><span class="va">odbc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbConnect-OdbcDriver-method.html">dbConnect</a></span><span class="op">(</span><span class="fu">odbc</span><span class="fu">::</span><span class="fu"><a href="reference/odbc.html">odbc</a></span><span class="op">(</span><span class="op">)</span>, dsn <span class="op">=</span> <span class="st">"MicrosoftSQLServer"</span>, UID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SQLSERVER_UID"</span><span class="op">)</span>, PWD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SQLSERVER_PWD"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">odbc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbReadTable.html" class="external-link">dbReadTable</a></span><span class="op">(</span><span class="va">odbc</span>, <span class="st">"flights"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   1.334   0.065   1.406</span></span>
<span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">odbc_result</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 336,776 x 19</span></span>
<span><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1  2013     1     1      517            515         2      830</span></span>
<span><span class="co">#&gt;  2  2013     1     1      533            529         4      850</span></span>
<span><span class="co">#&gt;  3  2013     1     1      542            540         2      923</span></span>
<span><span class="co">#&gt;  4  2013     1     1      544            545        -1     1004</span></span>
<span><span class="co">#&gt;  5  2013     1     1      554            600        -6      812</span></span>
<span><span class="co">#&gt;  6  2013     1     1      554            558        -4      740</span></span>
<span><span class="co">#&gt;  7  2013     1     1      555            600        -5      913</span></span>
<span><span class="co">#&gt;  8  2013     1     1      557            600        -3      709</span></span>
<span><span class="co">#&gt;  9  2013     1     1      557            600        -3      838</span></span>
<span><span class="co">#&gt; 10  2013     1     1      558            600        -2      753</span></span>
<span><span class="co">#&gt; # … with 336,766 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">rodbc_result</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">odbc_result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">rodbc_result</span>, <span class="va">odbc_result</span>, <span class="va">odbc</span>, <span class="va">rodbc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/gc.html" class="external-link">gc</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="writing-1">Writing<a class="anchor" aria-label="anchor" href="#writing-1"></a>
</h3>
<p>Writing the same dataset to the database.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/nycflights13" class="external-link">nycflights13</a></span><span class="op">)</span></span>
<span><span class="co"># rodbc does not support writing timestamps natively, so we remove that column</span></span>
<span><span class="va">flights2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">flights</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">flights</span><span class="op">)</span> <span class="op">!=</span> <span class="st">"time_hour"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">rodbc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbConnect-OdbcDriver-method.html">dbConnect</a></span><span class="op">(</span><span class="fu">RODBCDBI</span><span class="fu">::</span><span class="fu">ODBC</span><span class="op">(</span><span class="op">)</span>, dsn <span class="op">=</span> <span class="st">"MicrosoftSQLServer"</span>, user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SQLSERVER_UID"</span><span class="op">)</span>, password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SQLSERVER_PWD"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html" class="external-link">dbWriteTable</a></span><span class="op">(</span><span class="va">rodbc</span>, <span class="st">"flights2"</span>, <span class="va">flights2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed</span></span>
<span><span class="co">#&gt;  11.891   6.269 765.269</span></span>
<span></span>
<span><span class="co"># Now using odbc</span></span>
<span><span class="va">odbc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbConnect-OdbcDriver-method.html">dbConnect</a></span><span class="op">(</span><span class="fu">odbc</span><span class="fu">::</span><span class="fu"><a href="reference/odbc.html">odbc</a></span><span class="op">(</span><span class="op">)</span>, dsn <span class="op">=</span> <span class="st">"MicrosoftSQLServer"</span>, UID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SQLSERVER_UID"</span><span class="op">)</span>, PWD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SQLSERVER_PWD"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">flights3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">flights</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html" class="external-link">dbWriteTable</a></span><span class="op">(</span><span class="va">odbc</span>, <span class="st">"flights3"</span>, <span class="va">flights3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed</span></span>
<span><span class="co">#&gt;   2.617   0.275   9.649</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=odbc" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/r-dbi/odbc/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/r-dbi/odbc/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing odbc</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jim Hester <br><small class="roles"> Author </small>  </li>
<li>Hadley Wickham <br><small class="roles"> Author, maintainer </small>  </li>
<li>RStudio <br><small class="roles"> Copyright holder, funder </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/" class="external-link"><img src="http://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://cran.r-project.org/package=odbc" class="external-link"><img src="http://www.r-pkg.org/badges/version/odbc" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://github.com/r-dbi/odbc" class="external-link"><img src="https://github.com/r-dbi/odbc/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://codecov.io/github/r-dbi/odbc?branch=master" class="external-link"><img src="https://img.shields.io/codecov/c/github/r-dbi/odbc/master.svg" alt="Coverage Status"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jim Hester, Hadley Wickham, RStudio.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
